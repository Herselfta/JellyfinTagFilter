# 📱 Jellyfin 标签筛选器 - 手机 APP 体验指南

## 🎯 核心说明

由于 **Jellyfin 手机 APP 是原生应用**，无法直接在其中添加自定义功能。但我们提供了接近原生 APP 的体验方案。

## ✅ 推荐方案：PWA（渐进式 Web 应用）

PWA 可以让网页像原生 APP 一样使用，体验接近真实 APP：
- ✅ 添加到主屏幕
- ✅ 全屏运行（无浏览器地址栏）
- ✅ 可以离线缓存
- ✅ 与 Jellyfin 风格一致

## 🚀 快速部署

### 步骤 1：部署文件到服务器

```powershell
# 在 PowerShell 中运行
cd "C:\Users\Administrator\Documents\Personal_Materials\Scripts\JellyfinTagFilter"

# 方式 1：使用一键部署脚本（推荐）
.\一键部署PWA.ps1

# 方式 2：手动复制
Copy-Item "jellyfin_tag_filter_pwa.html" "D:\JellyfinServer\wwwroot\tag_filter_pwa.html"
Copy-Item "tag_filter_manifest.json" "D:\JellyfinServer\wwwroot\tag_filter_manifest.json"
```

### 步骤 2：手机访问

**获取服务器 IP 地址：**

```powershell
# 在电脑上运行
ipconfig
# 找到类似 192.168.x.x 的局域网 IP
```

**手机浏览器打开：**
```
http://你的服务器IP:8096/tag_filter_pwa.html
```

例如：`http://192.168.1.100:8096/tag_filter_pwa.html`

### 步骤 3：添加到主屏幕（像 APP 一样）

#### iOS (iPhone/iPad)

1. 在 **Safari** 浏览器中打开筛选器
2. 点击底部**分享按钮** (方框+箭头图标)
3. 滑动找到 **"添加到主屏幕"**
4. 点击 **"添加"**
5. 完成！主屏幕会出现"标签筛选"图标

**启动：**
- 像打开普通 APP 一样点击图标
- 全屏运行，无浏览器界面
- 体验接近原生 APP

#### Android

1. 在 **Chrome** 浏览器中打开筛选器
2. 点击右上角 **⋮** 菜单
3. 选择 **"添加到主屏幕"** 或 **"安装应用"**
4. 点击 **"添加"**
5. 完成！主屏幕会出现"标签筛选"图标

**启动：**
- 像打开普通 APP 一样点击图标
- 独立窗口运行
- 可在最近任务中切换

## 📱 PWA 版本特性

### 1. Jellyfin 原生风格
- 🎨 黑色主题，与 Jellyfin 一致
- 🎯 顶部导航栏
- 💫 流畅的动画效果

### 2. 手机优化
- 👆 触摸友好的大按钮
- 📏 响应式布局
- ⚡ 快速加载
- 💾 自动保存配置

### 3. 便捷操作
- 🔧 可折叠的配置面板
- 🔄 快速刷新按钮
- 🏷️ 一键清除标签选择
- 🔍 标签搜索功能

## 🎯 使用流程

### 首次配置

1. **点击右上角齿轮图标**打开配置
2. **填写信息：**
   - 服务器地址：`http://192.168.x.x:8096`
   - API 密钥：从 Jellyfin 后台获取
   - 媒体库 ID：从 Jellyfin 媒体库 URL 获取
3. **点击"加载媒体库"**
4. 配置自动保存，下次无需重新输入

### 日常使用

1. **打开 APP**（点击主屏幕图标）
2. **选择标签**（可多选）
3. **查看结果**（只显示同时包含所有标签的媒体）
4. **点击媒体**自动跳转到 Jellyfin 播放

## 🆚 与原生 APP 对比

| 功能 | Jellyfin APP | PWA 筛选器 | 说明 |
|------|-------------|-----------|------|
| 标签筛选逻辑 | OR（任一） | ✅ AND（全部） | **核心优势** |
| 安装方式 | 应用商店 | ✅ 添加到主屏幕 | 更简单 |
| 全屏运行 | ✅ | ✅ | 体验一致 |
| 离线使用 | ✅ | ⚠️ 需联网 | 需访问 API |
| 播放媒体 | ✅ | ➡️ 跳转到 Jellyfin | 点击即跳转 |
| 更新 | 需手动更新 | ✅ 自动更新 | 刷新即可 |

## 💡 使用技巧

### 技巧 1：快速筛选

1. 使用**标签搜索框**快速定位标签
2. 点击选择多个标签
3. 实时查看筛选结果

### 技巧 2：网格/列表切换

- **网格视图**：快速浏览海报
- **列表视图**：查看详细信息和所有标签

### 技巧 3：与 Jellyfin APP 配合

1. 在 PWA 筛选器中**找到想看的内容**
2. **点击媒体项**
3. 自动跳转到 Jellyfin（会打开 Jellyfin APP 或网页）
4. 直接播放

### 技巧 4：多设备使用

配置保存在各设备浏览器中：
- 手机配置一次，手机记住
- 平板配置一次，平板记住
- 电脑配置一次，电脑记住

## 🔧 高级配置

### 自定义服务器端口

如果 Jellyfin 使用其他端口：
```
http://192.168.x.x:端口号/tag_filter_pwa.html
```

### 公网访问

如果有域名或公网 IP：
```
https://你的域名/tag_filter_pwa.html
```

### HTTPS 配置

对于 HTTPS 的 Jellyfin 服务器：
- 服务器地址填写：`https://...`
- 确保证书有效

## 🔍 故障排除

### 问题 1：无法添加到主屏幕

**iOS：**
- 必须使用 **Safari** 浏览器
- 其他浏览器（Chrome、Firefox）不支持

**Android：**
- 推荐使用 **Chrome** 或 **Edge**
- 某些国产浏览器可能不支持

### 问题 2：手机无法访问

1. **检查网络：**
   ```powershell
   # 在服务器电脑上测试
   ping 192.168.x.x
   ```

2. **检查防火墙：**
   ```powershell
   # 以管理员运行
   New-NetFirewallRule -DisplayName "Jellyfin" -Direction Inbound -LocalPort 8096 -Protocol TCP -Action Allow
   ```

3. **确认 Jellyfin 运行：**
   - 电脑上能否访问 `http://localhost:8096`

### 问题 3：点击媒体无响应

- 检查是否阻止弹出窗口
- 或者页面会直接跳转（取决于浏览器设置）

### 问题 4：配置丢失

- 配置保存在浏览器 localStorage
- 清除浏览器数据会导致配置丢失
- 解决：重新填写配置（很快）

## 📊 性能优化

### 大媒体库优化

如果媒体库很大（5000+ 项）：
1. 首次加载可能需要 10-20 秒
2. 加载后筛选是即时的
3. 建议在 WiFi 环境使用

### 节省流量

- 海报图片会按需加载（lazy loading）
- 只加载可见区域的图片
- 滚动时自动加载更多

## 🎓 进阶使用

### 场景 1：精确筛选

想找"动作 + 科幻 + 2020s"的电影：
1. 选择"动作"标签
2. 选择"科幻"标签
3. 选择"2020s"标签
4. 结果只显示同时满足三个条件的电影

### 场景 2：快速清除重新筛选

1. 点击右上角"清除"按钮
2. 所有标签取消选择
3. 显示全部媒体
4. 重新选择新的标签组合

### 场景 3：配合 Eagle 同步

1. 在 Eagle 中为媒体打标签
2. 运行同步脚本更新到 Jellyfin
3. 在 PWA 筛选器中刷新
4. 新标签立即可用

## 📝 最佳实践

### 日常工作流

```
1. 早上：运行 Eagle 标签同步
2. 手机：打开 PWA 筛选器
3. 筛选：选择想看的类型标签
4. 观看：点击跳转到 Jellyfin APP
```

### 为什么不能直接集成到 Jellyfin APP？

**技术限制：**
- Jellyfin APP 是编译的原生应用
- 无法注入自定义代码
- 需要修改 APP 源码并重新编译

**PWA 方案的优势：**
- ✅ 无需修改 Jellyfin
- ✅ 跨平台（iOS、Android、Web）
- ✅ 易于更新和维护
- ✅ 用户体验接近原生

## 🚀 未来可能性

如果你有编程能力，可以考虑：

1. **开发 Jellyfin 插件**（C#）
   - 修改服务器端筛选逻辑
   - 所有客户端都能用

2. **Fork Jellyfin APP**
   - 修改移动端 APP 源码
   - 添加 AND 筛选功能
   - 自行编译安装

3. **贡献到官方**
   - 向 Jellyfin 官方提交 PR
   - 让 AND 筛选成为官方功能

## ✨ 总结

虽然无法直接在 Jellyfin APP 中实现，但 PWA 方案提供了：

- ✅ **接近原生的体验**
- ✅ **完整的 AND 筛选功能**
- ✅ **跨平台支持**
- ✅ **易于部署和使用**

**现在就试试吧！** 只需 3 分钟即可部署完成。

---

## 📞 需要帮助？

遇到问题？检查：
1. ✅ 服务器地址是否正确
2. ✅ API 密钥是否有效
3. ✅ 媒体库 ID 是否正确
4. ✅ 手机和服务器在同一网络
5. ✅ 防火墙未阻止 8096 端口

